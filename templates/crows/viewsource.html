{% extends "crows/crows.html" %}
{% block title %}Crows5{% endblock %}
{% block content %}
  {% if not has_access(current_user.username, 5) %}
    <div class="container secondary_container_danger bg-danger text-white text-center">
        <p>I see you are a very naughty crow!</p>
        <p>Challenges are sequential - you must be logged in as Crows5 to solve this level.</p>
        <p>Get back to Crows4 and grab the flag.</p>
    </div>
  {% else %}
    <div class="text-white container onerem">
        <p>
            &lt;?php
        </p>
        <p>
            <span class="var">$encodedSecret</span> = <code>"6e3557617956575a756c325a7556555a7a4a585a32566d55"</code>;
        <p>
        <span class="fct">function</span> encode(<span class="var">$secret</span>) {<br/>
        &emsp;&emsp;return <span class="fct">bin2hex</span>(<span class="fct">strrev</span>(<span class="fct">base64_encode</span>(<span class="var">$secret</span>)));<br/>
        }<br/>
        </p>
        <p>
            if&nbsp;(<span class="fct">array_key_exists</span>(<code>"submit"</code>, $_POST)) {<br/>
            &emsp;&emsp;if&nbsp;(<span class="fct">encode</span>($_POST[<code>'secret'</code>]) == <span class="var">$encodedSecret</span>) {<br/>
            &emsp;&emsp;&emsp;&emsp;<span class="fct">print</span> <code>"Access granted. Your secret is..."</code>;<br/>
            &emsp;&emsp;} else {<br/>
            &emsp;&emsp;&emsp;&emsp;<span class="fct">print</span> <code>"Wrong secret!"</code>;<br/>
            &emsp;&emsp;}<br/>
            }<br/><br/>
            ?&gt;<br/>
        </p>
    </div>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
        <div class="flash_container">
            <ul class="flashes alert alert-success text-center h3" id="flash">
                <i class="fas fa-crow" style="padding-right: 7px;"> </i>
                <p>{{ messages[0] }}</p>
            </ul>
        </div>
    {% endif %}
    {% endwith %}

{% endif %}
{% endblock %}

