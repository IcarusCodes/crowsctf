{% extends "crows/crows.html" %}
{% block title %}Crows7{% endblock %}
{% block content %}
  {% if not has_access(current_user.username, 7) %}
    <div class="container secondary_container_danger bg-danger text-white text-center">
        <p>I see you are a very naughty crow!</p>
        <p>Challenges are sequential - you must be logged in as Crows7 to solve this level.</p>
        <p>Get back to Crows6 and grab the flag.</p>
    </div>
  {% else %}
    <div class="text-white container onerem">
        <p>
            &lt;?php
        </p>
        <p>
            if (<span class="fct">array_key_exists</span>(<code>"needle"</code>, $_REQUEST)) {<br/>
            &emsp;&emsp;<span class="var">$needle</span> = $_REQUEST[<code>"needle"</code>];<br/>
            }<br/><br/>

            if (<span class="var">$needle</span> != <code>""</code>) {<br/>
            &emsp;&emsp;<span class="var">$substitutions</span> = [<code>';' => '', '&&' => '', '& ' => '', '|' => '', '||' => ''</code>];<br/>
            &emsp;&emsp;<span class="var">$needle</span> = <span class="fct">str_replace</span>(<span class="fct">array_keys</span>(<span class="var">$substitutions</span>), <span class="var">$substitutions</span>, <span class="var">$needle</span>);<br/><br/>
            &emsp;&emsp;<span class="fct">shell_exec</span>(<code>"grep -i <span class="var">$needle</span> words.txt"</code>);<br/>
            }<br/><br/>

            ?&gt;
        </p>
    </div>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
        <div class="flash_container">
            <ul class="flashes alert alert-success text-center h3" id="flash">
                <i class="fas fa-crow" style="padding-right: 7px;"> </i>
                <p>{{ messages[0] }}</p>
            </ul>
        </div>
    {% endif %}
    {% endwith %}

{% endif %}
{% endblock %}

