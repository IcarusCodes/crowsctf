{% extends "crows/crows.html" %}
{% block title %}Crows4{% endblock %}
{% block content %}
  {% if not has_access(current_user.username, 4) %}
    <div class="container secondary_container_danger bg-danger text-white text-center">
        <p>I see you are a very naughty crow!</p>
        <p>Challenges are sequential - you must be logged in as Crows4 to solve this level.</p>
        <p>Get back to Crows3 and grab the flag.</p>
    </div>
  {% else %}
      <div class="container text-white secondary_container">
       <p>Unauthorized to view this page.</p>
       <p>You are coming from
           <code>
            {% if request.headers.get('Referer') == None %}
             ""
            {% else %}
             {{ request.headers.get('Referer') }}
           {% endif %}
            </code>
           while authorized users should come from <code>https://crowsctf.com/crows5</code>
       </p>
      </div>
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="flash_container">
            <ul class="flashes alert alert-success text-center h3" id="flash">
                <i class="fas fa-crow" style="padding-right: 7px;"> </i>
                <p>{{ messages[0] }}</p>
            </ul>
        </div>
        {% endif %}
        {% endwith %}
   {% endif %}
{% endblock %}

